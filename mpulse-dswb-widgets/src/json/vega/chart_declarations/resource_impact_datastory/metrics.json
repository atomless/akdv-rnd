{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "width": 1200,
  "height": 80,
  "padding": 0,
  "data": [
    {
      "url": "https://localhost:3000/2.2.5/data/resource_impact_datastory.json",
      "name": "metric_data"
    },
    {
      "name": "metric_data_original",
      "source": "metric_data",
      "transform": [
        {
          "type": "project",
          "fields": [
            "charts.0.metrics.original.page_load",
            "charts.0.metrics.original.conversion",
            "charts.0.metrics.original.total_revenue",
            "charts.0.metrics.original.bounce_rate",
            "charts.0.metrics.original.session_duration",
            "charts.0.metrics.original.pages_per_session",
            "charts.0.metrics.original.time_on_page"
          ],
          "as": [
            "page_load",
            "conversion",
            "total_revenue",
            "bounce_rate",
            "session_duration",
            "pages_per_session",
            "time_on_page"
          ]
        }
      ]
    },
    {
      "name": "metric_data_projected",
      "source": "metric_data",
      "transform": [
        {
          "type": "project",
          "fields": [
            "charts.0.metrics.projected.page_load",
            "charts.0.metrics.projected.conversion",
            "charts.0.metrics.projected.total_revenue",
            "charts.0.metrics.projected.bounce_rate",
            "charts.0.metrics.projected.session_duration",
            "charts.0.metrics.projected.pages_per_session",
            "charts.0.metrics.projected.time_on_page"
          ],
          "as": [
            "page_load",
            "conversion",
            "total_revenue",
            "bounce_rate",
            "session_duration",
            "pages_per_session",
            "time_on_page"
          ]
        }
      ]
    }
  ],
  "signals": [
    {
      "name": "total_revenue_change",
      "update": "data('metric_data_projected')[0].total_revenue - data('metric_data_original')[0].total_revenue"
    }
  ],
  "scales": [],
  "axes": [],
  "legends": [],
  "marks": [
    {
      "type": "group",
      "name": "page_group_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 0
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 180
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Page Load"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 19
              },
              "fontSize": {
                "value": 20
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "data('metric_data_projected')[0].page_load + 's'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "format((data('metric_data_projected')[0].page_load - data('metric_data_original')[0].page_load) * 1000,'+,.0f') + 'ms'"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
    {
      "type": "group",
      "name": "conversion_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 180
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 180
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Conversion"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "data('metric_data_projected')[0].conversion + '%'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "format((data('metric_data_projected')[0].conversion - data('metric_data_original')[0].conversion),'+.2f') + 'pts'"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
    {
      "type": "group",
      "name": "total_revenue_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 360
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 210
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Total Revenue"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "data('metric_data_projected')[0].total_revenue < 1000000 ? format(data('metric_data_projected')[0].total_revenue, '$,.0f') : format(data('metric_data_projected')[0].total_revenue / 1000000, '$,.1f') + 'M'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "total_revenue_change < 1000000 ? format(total_revenue_change,'+$,.0f') : format(total_revenue_change / 1000000,'+$,.2f')"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
    {
      "type": "group",
      "name": "bounce_rate_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 570
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 195
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Bounce Rate"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "format(data('metric_data_projected')[0].bounce_rate, ',.2f') + '%'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "format((data('metric_data_projected')[0].bounce_rate - data('metric_data_original')[0].bounce_rate), '+.2f') + 'pts'"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
    {
      "type": "group",
      "name": "session_duration_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 765
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 230
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Session Duration"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "timeFormat(data('metric_data_projected')[0].session_duration, '%-M:%S') + 'm:s'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "timeFormat((data('metric_data_projected')[0].session_duration - data('metric_data_original')[0].session_duration),'%-M:%S') + 'm:s'"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
        {
      "type": "group",
      "name": "pages_per_session_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 995
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 220
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Pages per Session"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "format(data('metric_data_projected')[0].pages_per_session, '.1f')"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "format((data('metric_data_projected')[0].pages_per_session - data('metric_data_original')[0].pages_per_session),'+.1f')"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    },
        {
      "type": "group",
      "name": "time_on_page_metric_group",
      "encode": {
        "enter": {
          "stroke": {
            "value": "hsl(210, 40%, 65%)"
          },
          "x": [
            {
              "value": 1215
            }
          ],
          "y": [
            {
              "value": 0
            }
          ],
          "width": [
            {
              "value": 180
            }
          ],
          "height": [
            {
              "value": 80
            }
          ],
          "clip": [
            {
              "value": true
            }
          ],
          "strokeWidth": [
            {
              "value": 1
            }
          ]
        },
        "update": {}
      },
      "marks": [
        {
          "type": "symbol",
          "encode": {
            "enter": {
              "size": {
                "signal": "50 * 50"
              },
              "x": {
                "value": 26
              },
              "y": {
                "value": 26
              },
              "fill": {
                "value": "hsla(140, 100%, 45%, 0)"
              },
              "stroke": {
                "value": "hsl(140, 100%, 45%)"
              },
              "strokeWidth": {
                "value": 2
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "text": {
                "value": "Time on Page"
              },
              "x": {
                "value": 62
              },
              "y": {
                "value": 20
              },
              "fontSize": {
                "value": 19
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              },
              "fill": {
                "value": "hsl(210, 40%, 65%)"
              }
            },
            "update": {}
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 48
              },
              "fontSize": {
                "value": 22
              },
              "font": {
                "value": "Lato"
              }
            },
            "update": {
              "text": {
                "signal": "format(data('metric_data_projected')[0].time_on_page, '.1f') + 's'"
              },
              "fill": {
                "value": "hsl(210, 60%, 40%)"
              }
            }
          }
        },
        {
          "type": "text",
          "encode": {
            "enter": {
              "x": {
                "value": 62
              },
              "y": {
                "value": 72
              },
              "fontSize": {
                "value": 16
              },
              "font": {
                "value": "Lato"
              },
              "fontWeight": {
                "value": "300"
              }
            },
            "update": {
              "text": {
                "signal": "format((data('metric_data_projected')[0].time_on_page - data('metric_data_original')[0].time_on_page),'+.2f') + 's'"
              },
              "fill": {
                "value": "hsl(140, 100%, 35%)"
              }
            }
          }
        }
      ]
    }
  ]
}